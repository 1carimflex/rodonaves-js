!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("axios"),require("qs"),require("tls")):"function"==typeof define&&define.amd?define(["exports","axios","qs","tls"],e):e((t=t||self).rodonaves={},t.axios,t.qs,t.tls)}(this,function(t,p,f,h){"use strict";function c(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function e(u){return function(){var t=this,a=arguments;return new Promise(function(e,r){var n=u.apply(t,a);function o(t){c(n,e,r,o,i,"next",t)}function i(t){c(n,e,r,o,i,"throw",t)}o(void 0)})}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(){if("undefined"!=typeof Reflect&&Reflect.construct&&!Reflect.construct.sham){if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}}function l(t,e,r){return(l=s()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));return r&&u(o,r.prototype),o}).apply(null,arguments)}function y(t){var n="function"==typeof Map?new Map:void 0;return(y=function(t){if(null===t||(e=t,-1===Function.toString.call(e).indexOf("[native code]")))return t;var e;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,r)}function r(){return l(t,arguments,a(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),u(r,t)})(t)}function d(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function v(n){return function(){var t,e=a(n);if(s()){var r=a(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return d(this,t)}}function m(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return r}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}p=p&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p,f=f&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f,h=h&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h;var g=function(){i(n,y(Error));var r=v(n);function n(t){var e;return o(this,n),(e=r.call(this,"Server error status ".concat(t," "))).name="RodonavesFetchServerError",e}return n}(),b=function(){i(r,y(Error));var e=v(r);function r(){var t;return o(this,r),(t=e.call(this,"Client error")).name="RodonavesFetchClientError",t}return r}(),w=function(){i(r,y(Error));var e=v(r);function r(){var t;return o(this,r),(t=e.call(this,"Other Error")).name="RodonavesFetchOtherError",t}return r}();function r(){return(r=e(regeneratorRuntime.mark(function t(e){var r,n,o,i,a,u,c,s=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=1<s.length&&void 0!==s[1]?s[1]:"GET",n=2<s.length&&void 0!==s[2]?s[2]:{},o=3<s.length&&void 0!==s[3]?s[3]:{},i=4<s.length&&void 0!==s[4]?s[4]:"application/json",h.DEFAULT_MIN_VERSION="TLSv1",a={"Content-Type":i},this.token&&(a.Authorization="Bearer ".concat(this.token)),u=o,"multipart/form-data"===i&&(u=f.stringify(o)),t.prev=9,t.next=12,p({baseURL:"https://01wapi.rte.com.br/",method:r,url:e,timeout:this.timeout,headers:a,params:n,data:u});case 12:return c=t.sent,t.abrupt("return",c.data);case 16:if(t.prev=16,t.t0=t.catch(9),t.t0.response)throw new g(t.t0.response.status);t.next=22;break;case 22:if(t.t0.request)throw new b;t.next=26;break;case 26:throw new w;case 27:case"end":return t.stop()}},t,this,[[9,16]])}))).apply(this,arguments)}function x(){return(x=e(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.fetch("/token","POST",void 0,{auth_type:this.mode,grant_type:"password",username:this.username,password:this.password},"multipart/form-data");case 2:return e=t.sent,this.token=e.access_token,t.abrupt("return",!0);case 5:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}function O(){return(O=e(regeneratorRuntime.mark(function t(e){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.match(/\d+/g).join(""),this.token){t.next=4;break}return t.next=4,this.auth();case 4:return t.abrupt("return",this.fetch("/api/v1/busca-por-cep","GET",{zipCode:r}));case 5:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}function C(){return(C=e(regeneratorRuntime.mark(function t(e,r,n,o,i){var a,u,c,s,p,f,h,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n&&0!==n.length){t.next=2;break}throw new Error("Packs can not be null or empty");case 2:if(this.token){t.next=5;break}return t.next=5,this.auth();case 5:return a=0,n.forEach(function(t){a+=t.weight}),u=e.match(/\d+/g).join(""),c=r.match(/\d+/g).join(""),t.next=11,Promise.all([this.getCityByZipCode(u),this.getCityByZipCode(c)]);case 11:return s=t.sent,p=m(s,2),f=p[0],h=p[1],l={OriginCityId:f.CityId,OriginZipCode:e,DestinationCityId:h.CityId,DestinationZipCode:r,TotalWeight:a,EletronicInvoiceValue:o,CustomerTaxIdRegistration:i,Packs:n.map(function(t){return{AmountPackages:1,Weight:t.weight,Length:t.length,Height:t.height,Width:t.width}})},t.abrupt("return",this.fetch("/api/v1/simula-cotacao","POST",{},l));case 17:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}function R(){return(R=e(regeneratorRuntime.mark(function t(e,r){var n,o,i,a,u,c,s,p,f;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.match(/\d+/g).join(""),o=r.match(/\d+/g).join(""),this.token){t.next=5;break}return t.next=5,this.auth();case 5:return t.next=7,Promise.all([this.getCityByZipCode(n),this.getCityByZipCode(o)]);case 7:return i=t.sent,a=m(i,2),u=a[0],c=a[1],s={OriginCityDescription:u.CityDescription,OriginUFDescription:u.UnitFederation.Description,DestinationCityDescription:c.CityDescription,DestinationUFDescription:c.UnitFederation.Description},t.next=14,this.fetch("/api/v1/prazo-entrega","POST",{},s);case 14:return p=t.sent,f=p.DeliveryTime,t.abrupt("return",f);case 17:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}function k(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"dev",n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1e3;this.mode=r,this.username=t,this.password=e,this.timeout=n,this.token=null}((k.prototype={}).constructor=k).prototype.fetch=function(t){return r.apply(this,arguments)},k.prototype.auth=function(){return x.apply(this,arguments)},k.prototype.getCityByZipCode=function(t){return O.apply(this,arguments)},k.prototype.getDeliveryTime=function(t,e){return R.apply(this,arguments)},k.prototype.simulateQuote=function(t,e,r,n,o){return C.apply(this,arguments)},t.Rodonaves=k,t.RodonavesFetchClientError=b,t.RodonavesFetchOtherError=w,t.RodonavesFetchServerError=g,t.default=k,Object.defineProperty(t,"__esModule",{value:!0})});